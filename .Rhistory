corrplot(correlation_matrix, method = "circle" )
library(corrplot)
correlation_matrix <- cor(data[, sapply(data, is.numeric)])
corrplot(correlation_matrix, method = "circle" )
library(corrplot)
correlation_matrix <- cor(data[, sapply(data, is.numeric)])
corrplot(correlation_matrix, method = "circle", tl.pos = "n" )
library(dplyr)
library(fastDummies)
data_before_cleaning
library(dplyr)
library(fastDummies)
data_before_cleaning <- na.omit(read.csv2("../Competision-BootCamp/data_atlas.csv", sep=","))
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
filter(!overdue_payments %in% c("2", "3", "4")) %>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data_before_cleaning <- na.omit(read.csv2("../Competision-BootCamp/data_atlas.csv", sep=","))
data_before_cleaning
data_before_cleaning %>% filter(credit_history = "")
data_before_cleaning %>% filter(credit_history == "")
data_before_cleaning[data_before_cleaning == ""]
length(data_before_cleaning[data_before_cleaning == ""])
length(data_before_cleaning[data_before_cleaning != ""])
length(data_before_cleaning[data_before_cleaning == ""])
length(data_before_cleaning[data_before_cleaning != ""])
data_before_cleaning
library(tidyverse)
data_before_cleaning %>% mutate(across(everything(), str_replace(pattern = "", replacement = NA) ))
data_before_cleaning %>%
mutate(across(everything(), ~str_replace(., "^$", NA_character_)))
d2 <- data_before_cleaning %>%
mutate(across(everything(), ~str_replace(., "^$", NA_character_)))
summary(d2)
summary(is.na(d2))
levels(d2)
levels(as.factor(d2$credit_history))
d2
library(tidyverse)
library(DT)
summary_data <- summary(data)
data <- as.data.frame(lapply( (read.csv2("../Competision-BootCamp/data_after_preparation.csv", sep=","))[-1] , as.numeric))
data
library(tidyverse)
library(DT)
summary_data <- summary(data)
summary_df <- as.data.frame(t(summary_data))
datatable(summary_df,
options = list(pageLength = 6, autoWidth = TRUE), rownames = FALSE )
library(tidyverse)
library(fastDummies)
data_before_cleaning <- na.omit(read.csv2("../Competision-BootCamp/data_atlas.csv", sep=","))
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
filter(!overdue_payments %in% c("2", "3", "4")) %>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
write.csv(data, "data_after_preparation.csv", row.names = TRUE)
data <- as.data.frame(lapply( (read.csv2("../Competision-BootCamp/data_after_preparation.csv", sep=","))[-1] , as.numeric))
data
library(tidyverse)
library(fastDummies)
data_before_cleaning <- na.omit(read.csv2("../Competision-BootCamp/data_atlas.csv", sep=","))
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
filter(!overdue_payments %in% c("2", "3", "4")) %>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
saveRDS(data, "data_after_preparation.rds", row.names = TRUE)
saveRDS(data, "data_after_preparation.rds")
getwd()
knitr::opts_chunk$set(echo = TRUE)
data <- readRDS("data_after_preparation.rds")
data
data
library(tidyverse)
library(DT)
summary_data <- summary(data)
summary_df <- as.data.frame(t(summary_data))
datatable(summary_df,
options = list(pageLength = 6, autoWidth = TRUE), rownames = FALSE )
library(tidyverse)
ggplot(data, aes( x = as.factor(children), fill = as.factor(credit_risk)))+
geom_bar()
ggplot(data, aes( x = as.factor(children), fill = as.factor(credit_risk)))+
geom_bar(position = "fill")
ggplot(data[credit_risk==1], aes( x = as.factor(children)))+
geom_bar(position = "fill")
library(tidyverse)
ggplot(data[data$credit_risk==1], aes( x = as.factor(children)))+
geom_bar(position = "fill")
library(tidyverse)
ggplot(data["credit_risk"==1], aes( x = as.factor(children)))+
geom_bar(position = "fill")
library(tidyverse)
ggplot(data[data$credit_risk==1], aes( x = as.factor(children)))+
geom_bar()
ggplot(data[,data$credit_risk==1], aes( x = as.factor(children)))+
geom_bar()
library(tidyverse)
data %>%
filter(credit_risk == 1) %>%
ggplot( aes( x = as.factor(children)))+
geom_bar()
data %>%
filter(credit_risk == 1) %>%
ggplot( aes( x = as.factor(children)))+
geom_bar(position = "fill")
library(tidyverse)
data %>%
filter(credit_risk == 1) %>%
ggplot( aes( x = as.factor(children)))+
geom_bar()
library(tidyverse)
data %>%
filter(credit_risk == 1) %>%
ggplot( aes( x = as.factor(children), fill = education_wyższe))+
geom_bar()
library(tidyverse)
data %>%
filter(credit_risk == 1) %>%
ggplot( aes( x = as.factor(children), fill = education_wyższe))+
geom_bar(position = "fill")
geom_bar(position = "fill")
data %>%
filter(credit_risk == 1) %>%
ggplot( aes( x = as.factor(children), fill = as.factor(education_wyższe)))+
geom_bar(position = "fill")
library(tidyverse)
data %>%
ggplot( aes( x = as.factor(children), fill = as.factor(education_wyższe)))+
geom_bar(position = "fill")
library(tidyverse)
data %>%
filter(credit_risk == 1) %>%
ggplot( aes( x = as.factor(children), fill = as.factor(education_wyższe)))+
geom_bar(position = "fill")
data %>%
filter(credit_risk == 0) %>%
ggplot( aes( x = as.factor(children), fill = as.factor(education_wyższe)))+
geom_bar(position = "fill")
data %>%
ggplot( aes( x = as.factor(children), fill = as.factor(education_średnie)))+
geom_bar(position = "fill")
library(tidyverse)
data %>%
ggplot( aes( x = as.factor(children), fill = as.factor(education_podstawowe)))+
geom_bar(position = "fill")
data %>%
ggplot( aes( x = as.factor(active_loans), fill = as.factor(children)))+
geom_bar(position = "fill")
data[active_loans == 8]
data[data$active_loans == 8]
data %>%
filter(active_loans == 8)
library(tidyverse)
data %>%
ggplot( aes( x = as.factor(active_loans), fill = as.factor(children)))+
geom_bar()
data %>%
ggplot( aes( x = as.factor(active_loans), fill = as.factor(credit_history)))+
geom_bar()
library(tidyverse)
data %>%
ggplot( aes( x = income, fill = as.factor(credit_risk)))+
geom_bar(position = "fill")
library(tidyverse)
data %>%
ggplot( aes( x = income, fill = as.factor(credit_risk)))+
geom_histogram()
data %>%
ggplot( aes( x = income, fill = as.factor(credit_risk)))+
boxplot()
library(tidyverse)
data %>%
ggplot( aes( x = income))+
boxplot()
library(tidyverse)
data %>%
ggplot( aes( x = credit_risk, y = income))+
boxplot()
data %>%
ggplot( aes( x = as.factor(credit_risk), y = income))+
boxplot()
library(tidyverse)
data %>%
ggplot( aes( x = as.factor(credit_risk), y = income))+
boxplot()
data %>%
ggplot( aes( x = as.factor(credit_risk), y = income))+
geom_boxplot()
library(tidyverse)
data %>%
ggplot( aes( x = as.factor(credit_risk), y = age))+
geom_boxplot()
data %>%
ggplot( aes( x = as.factor(credit_risk), y = assets_value))+
geom_boxplot()
library(tidyverse)
data %>%
ggplot( aes( x = as.factor(credit_risk), y = assets_value))+
geom_barplot()
library(tidyverse)
data %>%
ggplot( aes( x = as.factor(credit_risk), y = assets_value))+
geom_bar()
data %>%
ggplot( aes( x = as.factor(credit_risk), fill = active_loans))+
geom_bar()
data %>%
ggplot( aes( x = as.factor(credit_risk), fill = active_loans))+
geom_bar(position = "fill")
data %>%
ggplot( aes( x = as.factor(credit_risk), fill = active_loans))+
geom_bar(position = "dodge")
data %>%
ggplot( aes( x = as.factor(credit_risk), fill = active_loans))+
geom_bar(position = "fill")
knitr::opts_chunk$set(echo = TRUE)
data_before_cleaning <- na.omit(read.csv2("../Competision-BootCamp/data_atlas.csv", sep=","))
str(data_before_cleaning)
summary(data_before_cleaning)
str(data_before_cleaning)
data_before_cleaning %>% count(city) %>% arrange(desc(n))
library(tidyverse)
data_before_cleaning %>% count(city) %>% arrange(desc(n))
str(data_before_cleaning)
data_before_cleaning %>% count(children) %>% arrange(desc(n))
data_before_cleaning %>% count(credit_history) %>% arrange(desc(n))
data_before_cleaning %>% count(overdue_payments) %>% arrange(desc(n))
data_before_cleaning %>% count(active_loans) %>% arrange(desc(n))
data_before_cleaning %>% count(years_in_job) %>% arrange(desc(n))
data_before_cleaning %>% count(owns_property) %>% arrange(desc(n))
data_before_cleaning %>% count(other_loans) %>% arrange(desc(n))
data_before_cleaning %>% count(education) %>% arrange(desc(n))
data_before_cleaning %>% count(marital_status) %>% arrange(desc(n))
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
children = as.factor(ifelse(children >=3, "3+", children)),
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
library(tidyverse)
library(fastDummies)
data_before_cleaning <- na.omit(read.csv2("../Competision-BootCamp/data_atlas.csv", sep=","))
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
children = as.factor(ifelse(children >=3, "3+", children)),
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
children = ifelse(children >=3, "3+", children),
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
children = ifelse(as.numeric(children) >=3, "3+", children),
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
children = ifelse(children  %in% c("3", "4", "5"), "3+", children),
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data
str(data_before_cleaning)
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
children = ifelse(children  %in% c("0","1", "2"), children, "3+"),
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
children = ifelse(children  %in% c("0","1", "2"), children, "3+"),
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
children = as.numeric(children),
children = ifelse(children  >= 3, 3, children),
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
summary(data_before_cleaning)
data
str(data_before_cleaning)
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
filter(!overdue_payments %in% c("2", "3", "4")) %>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
children = ifelse(children >= 3, 3, children),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
filter(!overdue_payments %in% c("2", "3", "4")) %>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
children = as.factor(ifelse(children >= 3," 3+", children),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
filter(!overdue_payments %in% c("2", "3", "4")) %>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
filter(!overdue_payments %in% c("2", "3", "4")) %>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
children = ifelse(children >= 3,"3+", children),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
filter(!overdue_payments %in% c("2", "3", "4")) %>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
data
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
children = as.factor((children >= 3,"3+", children)),
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
children = as.factor((children >= 3,"3+", children)),
data <- data_before_cleaning[,c(-1,-16)] %>%
mutate(
across(everything(), ~str_replace(., "^$", NA_character_)),
income = as.numeric(str_replace(income, " złoty", "")),
children = as.numeric(ifelse(children == "brak", "0",
gsub(" dzieci", "", children)
)
),
children = ifelse(children >= 3,"3+", children),
credit_history = ifelse(credit_history == "dobra historia", 1, 0),
overdue_payments = ifelse(overdue_payments == "brak opóźnień", 1, 0),
owns_property = ifelse(owns_property == "tak", 1, 0),
assets_value = as.numeric(str_replace(income, " złoty", ""))
)%>%
filter(!overdue_payments %in% c("2", "3", "4")) %>%
dummy_cols(select_columns = c("education", "city", "marital_status", "employment_type"),remove_selected_columns = TRUE)
